<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D√©monstration Math√©matique - Programmation Quadratique pour Optimisation de Portefeuille</title>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true,
                packages: {'[+]': ['ams', 'newcommand', 'configMacros']}
            },
            options: {
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.8;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 15px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            font-style: italic;
            margin-bottom: 30px;
        }

        h2 {
            color: #764ba2;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-left: 5px solid #764ba2;
            padding-left: 15px;
        }

        h3 {
            color: #667eea;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .theorem {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .theorem-title {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .proof {
            background: #fff9e6;
            border-left: 4px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .proof-title {
            font-weight: bold;
            color: #f57c00;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .definition {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .definition-title {
            font-weight: bold;
            color: #2e7d32;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .formula {
            background: #f5f5f5;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            overflow-x: auto;
        }

        .step {
            margin: 15px 0;
            padding: 10px;
            background: #fafafa;
            border-radius: 5px;
        }

        .step-number {
            display: inline-block;
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 10px;
            font-weight: bold;
        }

        .highlight {
            background: #fff3cd;
            padding: 2px 5px;
            border-radius: 3px;
        }

        .note {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .note-title {
            font-weight: bold;
            color: #1976d2;
            margin-bottom: 5px;
        }

        ul, ol {
            margin-left: 30px;
            margin-top: 10px;
        }

        li {
            margin: 8px 0;
        }

        .matrix {
            display: inline-block;
            margin: 10px 0;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #d63384;
        }

        .conclusion {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-top: 40px;
            text-align: center;
        }

        .conclusion h2 {
            color: white;
            border: none;
            padding: 0;
        }

        @media print {
            body {
                background: white;
            }
            .container {
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ Programmation Quadratique pour Optimisation de Portefeuille</h1>
        <p class="subtitle">D√©monstration Math√©matique Compl√®te avec Preuve Formelle</p>
        
        <div style="background: #e3f2fd; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
            <p><strong>‚úÖ Fichier charg√© avec succ√®s !</strong> Si les formules math√©matiques ne s'affichent pas imm√©diatement, attendez quelques secondes le chargement de MathJax.</p>
            <p style="margin-top: 10px; font-size: 0.9em;">Si vous voyez ce message, le HTML fonctionne correctement. Les formules math√©matiques se chargeront automatiquement.</p>
        </div>
        
        <noscript>
            <div style="background: #ffebee; padding: 15px; border-radius: 5px; margin-bottom: 20px; border-left: 4px solid #f44336;">
                <p><strong>‚ö†Ô∏è JavaScript est d√©sactiv√©.</strong> Veuillez activer JavaScript pour afficher les formules math√©matiques.</p>
            </div>
        </noscript>

        <h2>üìê 1. Formulation du Probl√®me</h2>

        <div class="note" style="background: #fff3e0; border-left-color: #ff9800;">
            <div class="note-title" style="color: #e65100;">üí° Pourquoi cette formulation ?</div>
            <p><strong>Le probl√®me fondamental en gestion de portefeuille :</strong> Comment allouer son capital entre diff√©rents actifs pour maximiser le rendement tout en minimisant le risque ?</p>
            <p><strong>L'id√©e de Markowitz (1952) :</strong> Au lieu de chercher uniquement le rendement maximum, on cherche le meilleur <strong>compromis</strong> entre rendement et risque. C'est la base de la th√©orie moderne du portefeuille.</p>
            <p><strong>Pourquoi minimiser la variance ?</strong> La variance mesure la <strong>volatilit√©</strong> (l'√©cart-type des rendements). Un portefeuille avec une faible variance a des rendements plus stables et pr√©visibles, ce qui est g√©n√©ralement pr√©f√©r√© par les investisseurs averses au risque.</p>
            <p><strong>Le lien avec la diversification :</strong> En combinant des actifs avec des corr√©lations diff√©rentes, on peut r√©duire la variance totale du portefeuille sans n√©cessairement r√©duire le rendement. C'est le principe de la diversification.</p>
        </div>

        <div class="definition">
            <div class="definition-title">D√©finition 1.1 : Probl√®me d'Optimisation Mean-Variance (Markowitz)</div>
            <p>Soit un portefeuille de $n$ actifs. On cherche √† minimiser la variance du portefeuille sous contraintes de rendement et de budget.</p>
        </div>

        <div class="formula">
            <p><strong>Probl√®me d'optimisation :</strong></p>
            $$
            \begin{aligned}
            \min_{\mathbf{w}} \quad & \mathbf{w}^T \boldsymbol{\Sigma} \mathbf{w} \\
            \text{s.t.} \quad & \mathbf{w}^T \boldsymbol{\mu} = r_{\text{target}} \\
            & \mathbf{1}^T \mathbf{w} = 1 \\
            & \mathbf{w} \geq \mathbf{0} \\
            & \mathbf{w} \leq \mathbf{w}_{\max}
            \end{aligned}
            $$
        </div>

        <div class="note">
            <div class="note-title">Notations :</div>
            <ul>
                <li>$\mathbf{w} \in \mathbb{R}^n$ : vecteur de poids (allocation) du portefeuille</li>
                <li>$\boldsymbol{\Sigma} \in \mathbb{R}^{n \times n}$ : matrice de covariance des rendements (sym√©trique, d√©finie positive)</li>
                <li>$\boldsymbol{\mu} \in \mathbb{R}^n$ : vecteur des rendements esp√©r√©s</li>
                <li>$r_{\text{target}}$ : rendement cible du portefeuille</li>
                <li>$\mathbf{1} = [1, 1, \ldots, 1]^T$ : vecteur unitaire</li>
                <li>$\mathbf{w}_{\max}$ : vecteur des poids maximums autoris√©s</li>
            </ul>
        </div>

        <div class="note" style="background: #e8f5e9; border-left-color: #4caf50;">
            <div class="note-title" style="color: #2e7d32;">üîó Comprendre chaque contrainte :</div>
            <p><strong>1. $\mathbf{w}^T \boldsymbol{\mu} = r_{\text{target}}$ (Contrainte de rendement) :</strong></p>
            <p>Cette contrainte garantit que le portefeuille aura exactement le rendement esp√©r√© souhait√©. <strong>Pourquoi ?</strong> L'investisseur a un objectif de rendement pr√©cis. En fixant cette contrainte, on explore tous les portefeuilles possibles avec ce rendement, et on choisit celui avec le risque minimal.</p>
            
            <p><strong>2. $\mathbf{1}^T \mathbf{w} = 1$ (Contrainte de budget) :</strong></p>
            <p>Cela signifie que la somme des poids est √©gale √† 1 (100% du capital est investi). <strong>Pourquoi ?</strong> On ne peut pas investir plus que ce qu'on a, et on veut utiliser tout le capital disponible (pas de cash non investi dans ce mod√®le).</p>
            
            <p><strong>3. $\mathbf{w} \geq \mathbf{0}$ (Pas de vente √† d√©couvert) :</strong></p>
            <p>Chaque poids est positif ou nul. <strong>Pourquoi ?</strong> En vente √† d√©couvert, on emprunte un actif pour le vendre (poids n√©gatif). Cette contrainte simplifie le probl√®me et correspond √† la r√©glementation de nombreux OPCVM qui interdisent la vente √† d√©couvert.</p>
            
            <p><strong>4. $\mathbf{w} \leq \mathbf{w}_{\max}$ (Diversification) :</strong></p>
            <p>Limite le poids maximum par actif. <strong>Pourquoi ?</strong> Pour √©viter la concentration excessive (ex: mettre 90% dans un seul actif). C'est une contrainte de <strong>diversification</strong> importante pour les OPCVM qui doivent respecter des r√®gles de r√©partition du risque.</p>
        </div>

        <h2>üîç 2. Propri√©t√©s Math√©matiques</h2>

        <div class="note" style="background: #e1f5fe; border-left-color: #0288d1;">
            <div class="note-title" style="color: #01579b;">üí° Pourquoi la convexit√© est cruciale ?</div>
            <p><strong>Le probl√®me de l'optimisation non-convexe :</strong> Si la fonction objectif n'est pas convexe, il peut exister plusieurs <strong>minima locaux</strong>. Un algorithme pourrait trouver un minimum local qui n'est pas le meilleur (minimum global), et on ne saurait jamais si on a trouv√© la vraie solution optimale.</p>
            
            <p><strong>L'avantage de la convexit√© :</strong> Pour une fonction convexe, tout minimum local est automatiquement un <strong>minimum global</strong>. Cela garantit que :</p>
            <ul>
                <li>La solution trouv√©e est <strong>unique</strong> (si la fonction est strictement convexe)</li>
                <li>Les algorithmes d'optimisation convergent vers la <strong>vraie</strong> solution optimale</li>
                <li>On peut utiliser des m√©thodes efficaces et rapides (comme les solveurs QP)</li>
            </ul>
            
            <p><strong>Pourquoi $\mathbf{w}^T \boldsymbol{\Sigma} \mathbf{w}$ est convexe ?</strong> Cette forme quadratique repr√©sente la variance du portefeuille. La variance est toujours positive (ou nulle), ce qui se traduit math√©matiquement par le fait que $\boldsymbol{\Sigma}$ est semi-d√©finie positive. C'est cette propri√©t√© qui garantit la convexit√©.</p>
            
            <p><strong>Le lien avec la matrice de covariance :</strong> La matrice $\boldsymbol{\Sigma}$ contient les variances (diagonale) et les covariances (hors diagonale). Elle est toujours sym√©trique car $\text{Cov}(X_i, X_j) = \text{Cov}(X_j, X_i)$, et semi-d√©finie positive car elle repr√©sente une forme quadratique de variance (toujours $\geq 0$).</p>
        </div>

        <div class="theorem">
            <div class="theorem-title">Th√©or√®me 2.1 : Convexit√© du Probl√®me</div>
            <p>Le probl√®me d'optimisation mean-variance est un <span class="highlight">probl√®me de programmation quadratique convexe</span>.</p>
        </div>

        <div class="proof">
            <div class="proof-title">Preuve :</div>
            <div class="step">
                <span class="step-number">1</span>
                <strong>Fonction objectif :</strong> $f(\mathbf{w}) = \mathbf{w}^T \boldsymbol{\Sigma} \mathbf{w}$
            </div>
            <p>La matrice $\boldsymbol{\Sigma}$ est la matrice de covariance, donc elle est <strong>sym√©trique</strong> et <strong>semi-d√©finie positive</strong> (voire d√©finie positive si les actifs ne sont pas parfaitement corr√©l√©s).</p>
            
            <div class="step">
                <span class="step-number">2</span>
                <strong>Hessienne :</strong> $\nabla^2 f(\mathbf{w}) = 2\boldsymbol{\Sigma}$
            </div>
            <p>Pour v√©rifier la convexit√©, on calcule la Hessienne :</p>
            $$
            \frac{\partial^2 f}{\partial w_i \partial w_j} = 2\Sigma_{ij}
            $$
            <p>Donc $\nabla^2 f(\mathbf{w}) = 2\boldsymbol{\Sigma}$.</p>

            <div class="step">
                <span class="step-number">3</span>
                <strong>Condition de convexit√© :</strong>
            </div>
            <p>Puisque $\boldsymbol{\Sigma}$ est semi-d√©finie positive, pour tout $\mathbf{v} \in \mathbb{R}^n$ :</p>
            $$
            \mathbf{v}^T \nabla^2 f(\mathbf{w}) \mathbf{v} = 2\mathbf{v}^T \boldsymbol{\Sigma} \mathbf{v} \geq 0
            $$
            <p>Donc $f$ est <strong>convexe</strong>.</p>

            <div class="step">
                <span class="step-number">4</span>
                <strong>Contraintes lin√©aires :</strong>
            </div>
            <p>Les contraintes sont toutes <strong>lin√©aires</strong> (√©galit√©s et in√©galit√©s), donc l'ensemble r√©alisable est <strong>convexe</strong>.</p>

            <p><strong>Conclusion :</strong> Le probl√®me est un probl√®me d'optimisation convexe, garantissant l'existence d'un minimum global unique (si $\boldsymbol{\Sigma}$ est d√©finie positive).</p>
        </div>

        <h2>‚öôÔ∏è 3. Conditions de Karush-Kuhn-Tucker (KKT)</h2>

        <div class="note" style="background: #f3e5f5; border-left-color: #9c27b0;">
            <div class="note-title" style="color: #6a1b9a;">üí° Pourquoi les conditions KKT ?</div>
            <p><strong>Le probl√®me de l'optimisation avec contraintes :</strong> Quand on cherche le minimum d'une fonction avec des contraintes, on ne peut pas simplement annuler le gradient (comme en optimisation sans contraintes). Il faut tenir compte du fait que la solution doit respecter les contraintes.</p>
            
            <p><strong>L'id√©e du Lagrangien :</strong> Au lieu de minimiser $f(\mathbf{w})$ sous contraintes, on transforme le probl√®me en minimisant une fonction combin√©e (le Lagrangien) qui inclut les contraintes via des <strong>multiplicateurs de Lagrange</strong>. Ces multiplicateurs mesurent le "co√ªt" de chaque contrainte.</p>
            
            <p><strong>Intuition des multiplicateurs :</strong></p>
            <ul>
                <li><strong>$\lambda_1$ (rendement) :</strong> Mesure combien la variance augmenterait si on rel√¢chait la contrainte de rendement. Si $\lambda_1$ est grand, la contrainte de rendement est "co√ªteuse" en termes de risque.</li>
                <li><strong>$\lambda_2$ (budget) :</strong> Mesure l'impact de la contrainte de budget sur l'optimisation.</li>
                <li><strong>$\boldsymbol{\nu}$ (poids positifs) :</strong> Si $\nu_i > 0$, alors $w_i = 0$ (la contrainte est active). Cela signifie que l'actif $i$ n'est pas dans le portefeuille optimal.</li>
                <li><strong>$\boldsymbol{\eta}$ (poids maximums) :</strong> Si $\eta_i > 0$, alors $w_i = w_{\max,i}$ (on a atteint la limite).</li>
            </ul>
            
            <p><strong>Pourquoi "conditions n√©cessaires et suffisantes" ?</strong></p>
            <ul>
                <li><strong>N√©cessaires :</strong> Si $\mathbf{w}^*$ est optimal, alors il doit satisfaire les conditions KKT (on ne peut pas √™tre optimal sans les satisfaire).</li>
                <li><strong>Suffisantes :</strong> Si $\mathbf{w}^*$ satisfait les conditions KKT et que le probl√®me est convexe, alors $\mathbf{w}^*$ est optimal (c'est suffisant pour garantir l'optimalit√©).</li>
            </ul>
            
            <p><strong>Le lien avec l'optimisation :</strong> Les conditions KKT sont la g√©n√©ralisation des conditions classiques "gradient = 0" pour les probl√®mes avec contraintes. Elles permettent de caract√©riser math√©matiquement la solution optimale.</p>
        </div>

        <div class="theorem">
            <div class="theorem-title">Th√©or√®me 3.1 : Conditions KKT N√©cessaires et Suffisantes</div>
            <p>Pour un probl√®me d'optimisation convexe avec contraintes d'√©galit√© et d'in√©galit√©, les conditions KKT sont n√©cessaires et suffisantes pour l'optimalit√©.</p>
        </div>

        <div class="formula">
            <p><strong>Lagrangien :</strong></p>
            $$
            \mathcal{L}(\mathbf{w}, \lambda_1, \lambda_2, \boldsymbol{\nu}, \boldsymbol{\eta}) = \mathbf{w}^T \boldsymbol{\Sigma} \mathbf{w} 
            - \lambda_1(\mathbf{w}^T \boldsymbol{\mu} - r_{\text{target}})
            - \lambda_2(\mathbf{1}^T \mathbf{w} - 1)
            - \boldsymbol{\nu}^T \mathbf{w}
            - \boldsymbol{\eta}^T (\mathbf{w}_{\max} - \mathbf{w})
            $$
        </div>

        <div class="note">
            <div class="note-title">Multiplicateurs de Lagrange :</div>
            <ul>
                <li>$\lambda_1 \in \mathbb{R}$ : multiplicateur pour la contrainte de rendement</li>
                <li>$\lambda_2 \in \mathbb{R}$ : multiplicateur pour la contrainte de budget</li>
                <li>$\boldsymbol{\nu} \geq \mathbf{0}$ : multiplicateurs pour $\mathbf{w} \geq \mathbf{0}$</li>
                <li>$\boldsymbol{\eta} \geq \mathbf{0}$ : multiplicateurs pour $\mathbf{w} \leq \mathbf{w}_{\max}$</li>
            </ul>
        </div>

        <div class="proof">
            <div class="proof-title">Conditions KKT :</div>
            
            <div class="step">
                <span class="step-number">1</span>
                <strong>Stationnarit√© (gradient du Lagrangien = 0) :</strong>
            </div>
            $$
            \nabla_{\mathbf{w}} \mathcal{L} = 2\boldsymbol{\Sigma}\mathbf{w} - \lambda_1 \boldsymbol{\mu} - \lambda_2 \mathbf{1} - \boldsymbol{\nu} + \boldsymbol{\eta} = \mathbf{0}
            $$
            <p>Donc :</p>
            $$
            2\boldsymbol{\Sigma}\mathbf{w} = \lambda_1 \boldsymbol{\mu} + \lambda_2 \mathbf{1} + \boldsymbol{\nu} - \boldsymbol{\eta} \tag{1}
            $$

            <div class="step">
                <span class="step-number">2</span>
                <strong>Faisabilit√© primale :</strong>
            </div>
            $$
            \begin{aligned}
            \mathbf{w}^T \boldsymbol{\mu} &= r_{\text{target}} \tag{2} \\
            \mathbf{1}^T \mathbf{w} &= 1 \tag{3} \\
            \mathbf{w} &\geq \mathbf{0} \tag{4} \\
            \mathbf{w} &\leq \mathbf{w}_{\max} \tag{5}
            \end{aligned}
            $$

            <div class="step">
                <span class="step-number">3</span>
                <strong>Faisabilit√© duale :</strong>
            </div>
            $$
            \boldsymbol{\nu} \geq \mathbf{0}, \quad \boldsymbol{\eta} \geq \mathbf{0} \tag{6}
            $$

            <div class="step">
                <span class="step-number">4</span>
                <strong>Compl√©mentarit√© :</strong>
            </div>
            $$
            \begin{aligned}
            \nu_i w_i &= 0, \quad \forall i \tag{7} \\
            \eta_i (w_{\max,i} - w_i) &= 0, \quad \forall i \tag{8}
            \end{aligned}
            $$
            <p>Ces conditions signifient que si une contrainte n'est pas active (satellite), son multiplicateur est nul.</p>
        </div>

        <h2>üîß 4. R√©solution du Probl√®me</h2>

        <div class="note" style="background: #fff9c4; border-left-color: #fbc02d;">
            <div class="note-title" style="color: #f57f17;">üí° Pourquoi deux approches de r√©solution ?</div>
            <p><strong>Cas simplifi√© (analytique) :</strong> Quand on ignore les contraintes de bornes ($\mathbf{w} \geq \mathbf{0}$ et $\mathbf{w} \leq \mathbf{w}_{\max}$), on peut r√©soudre le probl√®me <strong>analytiquement</strong> (avec des formules explicites). C'est utile pour :</p>
            <ul>
                <li>Comprendre la structure math√©matique de la solution</li>
                <li>Calculer rapidement des approximations</li>
                <li>V√©rifier les r√©sultats des m√©thodes num√©riques</li>
            </ul>
            
            <p><strong>Cas g√©n√©ral (num√©rique) :</strong> Avec toutes les contraintes, on doit utiliser des <strong>algorithmes num√©riques</strong> car :</p>
            <ul>
                <li>Les contraintes d'in√©galit√© cr√©ent des "fronti√®res" dans l'espace des solutions</li>
                <li>Il faut identifier quelles contraintes sont "actives" (satellites) √† l'optimum</li>
                <li>La solution analytique devient trop complexe</li>
            </ul>
            
            <p><strong>Le lien avec les solveurs :</strong> Les solveurs modernes (CVXPY, scipy.optimize) utilisent des m√©thodes sophistiqu√©es (point int√©rieur, active-set) qui explorent intelligemment l'espace des solutions pour trouver l'optimum.</p>
        </div>

        <h3>4.1 Cas Simplifi√© (Sans Contraintes de Bornes)</h3>

        <p>Si on ignore les contraintes $\mathbf{w} \geq \mathbf{0}$ et $\mathbf{w} \leq \mathbf{w}_{\max}$ (ou si elles ne sont pas actives), le probl√®me devient :</p>

        <div class="formula">
            $$
            \begin{aligned}
            \min_{\mathbf{w}} \quad & \mathbf{w}^T \boldsymbol{\Sigma} \mathbf{w} \\
            \text{s.t.} \quad & \mathbf{w}^T \boldsymbol{\mu} = r_{\text{target}} \\
            & \mathbf{1}^T \mathbf{w} = 1
            \end{aligned}
            $$
        </div>

        <div class="proof">
            <div class="proof-title">R√©solution Analytique :</div>
            
            <div class="step">
                <span class="step-number">1</span>
                <strong>Lagrangien simplifi√© :</strong>
            </div>
            $$
            \mathcal{L} = \mathbf{w}^T \boldsymbol{\Sigma} \mathbf{w} - \lambda_1(\mathbf{w}^T \boldsymbol{\mu} - r_{\text{target}}) - \lambda_2(\mathbf{1}^T \mathbf{w} - 1)
            $$

            <div class="step">
                <span class="step-number">2</span>
                <strong>Condition de stationnarit√© :</strong>
            </div>
            $$
            \frac{\partial \mathcal{L}}{\partial \mathbf{w}} = 2\boldsymbol{\Sigma}\mathbf{w} - \lambda_1 \boldsymbol{\mu} - \lambda_2 \mathbf{1} = \mathbf{0}
            $$
            <p><strong>Pourquoi cette √©quation ?</strong> √Ä l'optimum, le gradient du Lagrangien doit √™tre nul. Cela signifie que le gradient de la fonction objectif ($2\boldsymbol{\Sigma}\mathbf{w}$) doit √™tre une combinaison lin√©aire des gradients des contraintes ($\boldsymbol{\mu}$ et $\mathbf{1}$). C'est l'id√©e fondamentale : √† l'optimum, on ne peut plus am√©liorer la fonction objectif sans violer les contraintes.</p>
            <p>Donc :</p>
            $$
            \mathbf{w} = \frac{1}{2}\boldsymbol{\Sigma}^{-1}(\lambda_1 \boldsymbol{\mu} + \lambda_2 \mathbf{1}) \tag{9}
            $$
            <p><strong>Intuition :</strong> La solution optimale est une combinaison lin√©aire de $\boldsymbol{\Sigma}^{-1}\boldsymbol{\mu}$ (qui favorise les actifs avec un bon ratio rendement/risque) et de $\boldsymbol{\Sigma}^{-1}\mathbf{1}$ (qui favorise les actifs avec une faible variance). Les multiplicateurs $\lambda_1$ et $\lambda_2$ ajustent l'√©quilibre entre ces deux objectifs.</p>

            <div class="step">
                <span class="step-number">3</span>
                <strong>D√©termination des multiplicateurs :</strong>
            </div>
            <p>En substituant (9) dans les contraintes (2) et (3) :</p>
            $$
            \begin{aligned}
            \frac{1}{2}(\lambda_1 \boldsymbol{\mu} + \lambda_2 \mathbf{1})^T \boldsymbol{\Sigma}^{-1} \boldsymbol{\mu} &= r_{\text{target}} \\
            \frac{1}{2}(\lambda_1 \boldsymbol{\mu} + \lambda_2 \mathbf{1})^T \boldsymbol{\Sigma}^{-1} \mathbf{1} &= 1
            \end{aligned}
            $$

            <p><strong>Pourquoi ces constantes A, B, C ?</strong> Ces quantit√©s apparaissent naturellement quand on substitue la solution dans les contraintes. Elles ont une interpr√©tation financi√®re importante :</p>
            <ul>
                <li><strong>$A = \boldsymbol{\mu}^T \boldsymbol{\Sigma}^{-1} \boldsymbol{\mu}$ :</strong> Mesure le "rendement ajust√© du risque" global. Plus A est grand, plus on peut obtenir de rendement pour un niveau de risque donn√©.</li>
                <li><strong>$B = \boldsymbol{\mu}^T \boldsymbol{\Sigma}^{-1} \mathbf{1}$ :</strong> Mesure la corr√©lation entre rendement et "inverse du risque". C'est un indicateur de la qualit√© globale des actifs.</li>
                <li><strong>$C = \mathbf{1}^T \boldsymbol{\Sigma}^{-1} \mathbf{1}$ :</strong> Mesure la "somme des inverses des risques". Plus C est grand, plus on peut diversifier efficacement.</li>
            </ul>
            <p>D√©finissons :</p>
            $$
            \begin{aligned}
            A &= \boldsymbol{\mu}^T \boldsymbol{\Sigma}^{-1} \boldsymbol{\mu} \\
            B &= \boldsymbol{\mu}^T \boldsymbol{\Sigma}^{-1} \mathbf{1} = \mathbf{1}^T \boldsymbol{\Sigma}^{-1} \boldsymbol{\mu} \\
            C &= \mathbf{1}^T \boldsymbol{\Sigma}^{-1} \mathbf{1}
            \end{aligned}
            $$

            <p>Le syst√®me devient :</p>
            $$
            \begin{bmatrix}
            A & B \\
            B & C
            \end{bmatrix}
            \begin{bmatrix}
            \lambda_1 \\
            \lambda_2
            \end{bmatrix}
            =
            \begin{bmatrix}
            2r_{\text{target}} \\
            2
            \end{bmatrix}
            $$

            <div class="step">
                <span class="step-number">4</span>
                <strong>Solution :</strong>
            </div>
            $$
            \begin{bmatrix}
            \lambda_1 \\
            \lambda_2
            \end{bmatrix}
            =
            \frac{1}{AC - B^2}
            \begin{bmatrix}
            C & -B \\
            -B & A
            \end{bmatrix}
            \begin{bmatrix}
            2r_{\text{target}} \\
            2
            \end{bmatrix}
            $$

            <p>En d√©veloppant :</p>
            $$
            \begin{aligned}
            \lambda_1 &= \frac{2(C r_{\text{target}} - B)}{AC - B^2} \\
            \lambda_2 &= \frac{2(A - B r_{\text{target}})}{AC - B^2}
            \end{aligned}
            $$

            <div class="step">
                <span class="step-number">5</span>
                <strong>Solution finale :</strong>
            </div>
            $$
            \mathbf{w}^* = \frac{1}{AC - B^2} \left[ (C r_{\text{target}} - B) \boldsymbol{\Sigma}^{-1} \boldsymbol{\mu} + (A - B r_{\text{target}}) \boldsymbol{\Sigma}^{-1} \mathbf{1} \right]
            $$
        </div>

        <h3>4.2 Cas G√©n√©ral (Avec Contraintes de Bornes)</h3>

        <p>Quand les contraintes $\mathbf{w} \geq \mathbf{0}$ et $\mathbf{w} \leq \mathbf{w}_{\max}$ sont pr√©sentes, le probl√®me ne peut g√©n√©ralement pas √™tre r√©solu analytiquement. On utilise des algorithmes num√©riques :</p>

        <div class="note">
            <div class="note-title">Algorithmes de R√©solution :</div>
            <ul>
                <li><strong>M√©thode du point int√©rieur :</strong> Pour probl√®mes convexes de grande taille</li>
                <li><strong>SLSQP (Sequential Least Squares Programming) :</strong> M√©thode s√©quentielle efficace</li>
                <li><strong>CVXPY / CVXOPT :</strong> Solveurs sp√©cialis√©s pour programmation convexe</li>
                <li><strong>M√©thode active-set :</strong> Identifie les contraintes actives</li>
            </ul>
        </div>

        <h2>üìä 5. Fronti√®re Efficiente</h2>

        <div class="note" style="background: #fce4ec; border-left-color: #e91e63;">
            <div class="note-title" style="color: #c2185b;">üí° Pourquoi la fronti√®re efficiente est fondamentale ?</div>
            <p><strong>Le dilemme rendement-risque :</strong> En finance, il y a un compromis fondamental : plus de rendement implique g√©n√©ralement plus de risque. La question est : <strong>quel est le meilleur compromis possible ?</strong></p>
            
            <p><strong>La fronti√®re efficiente r√©pond √† cette question :</strong> Elle montre tous les portefeuilles qui sont <strong>"efficients"</strong>, c'est-√†-dire :</p>
            <ul>
                <li>Pour un niveau de risque donn√©, ils ont le <strong>rendement maximum</strong> possible</li>
                <li>Pour un niveau de rendement donn√©, ils ont le <strong>risque minimum</strong> possible</li>
            </ul>
            
            <p><strong>Pourquoi "efficient" ?</strong> Tout portefeuille qui n'est <strong>pas</strong> sur la fronti√®re efficiente est "inefficient" : on peut trouver un autre portefeuille avec le m√™me risque mais plus de rendement, ou le m√™me rendement mais moins de risque. Un investisseur rationnel ne devrait jamais choisir un portefeuille inefficient.</p>
            
            <p><strong>La forme de la fronti√®re :</strong> La fronti√®re efficiente est g√©n√©ralement une <strong>courbe hyperbolique</strong> dans le plan (risque, rendement). Elle commence au "portefeuille de variance minimale" (le point le plus √† gauche) et monte vers la droite (plus de rendement = plus de risque).</p>
            
            <p><strong>Lien avec la diversification :</strong> La courbure de la fronti√®re efficiente montre les b√©n√©fices de la diversification. Plus la courbe est "courb√©e vers le haut", plus la diversification est efficace (on peut r√©duire le risque sans sacrifier trop de rendement).</p>
            
            <p><strong>Utilisation pratique :</strong> Un g√©rant de portefeuille peut :</p>
            <ul>
                <li>Choisir un point sur la fronti√®re selon son aversion au risque</li>
                <li>Comparer diff√©rents portefeuilles : ceux sur la fronti√®re sont meilleurs</li>
                <li>Visualiser l'impact de nouvelles contraintes (la fronti√®re se d√©place)</li>
            </ul>
        </div>

        <div class="definition">
            <div class="definition-title">D√©finition 5.1 : Fronti√®re Efficiente</div>
            <p>La fronti√®re efficiente est l'ensemble des portefeuilles qui minimisent la variance pour chaque niveau de rendement cible, ou inversement, maximisent le rendement pour chaque niveau de variance.</p>
        </div>

        <div class="proof">
            <div class="proof-title">Construction de la Fronti√®re Efficiente :</div>
            
            <p>Pour construire la fronti√®re efficiente, on r√©sout le probl√®me pour diff√©rentes valeurs de $r_{\text{target}}$ :</p>
            $$
            r_{\text{target}} \in [r_{\min}, r_{\max}]
            $$
            <p>o√π :</p>
            $$
            \begin{aligned}
            r_{\min} &= \min_{\mathbf{w}: \mathbf{1}^T \mathbf{w} = 1} \mathbf{w}^T \boldsymbol{\mu} \\
            r_{\max} &= \max_{\mathbf{w}: \mathbf{1}^T \mathbf{w} = 1} \mathbf{w}^T \boldsymbol{\mu}
            \end{aligned}
            $$

            <p>Pour chaque $r_{\text{target}}$, on obtient un portefeuille optimal $\mathbf{w}^*(r_{\text{target}})$ avec variance $\sigma^2(r_{\text{target}}) = \mathbf{w}^*(r_{\text{target}})^T \boldsymbol{\Sigma} \mathbf{w}^*(r_{\text{target}})$.</p>

            <p>La fronti√®re efficiente est la courbe $(\sigma(r_{\text{target}}), r_{\text{target}})$ dans le plan risque-rendement.</p>
        </div>

        <h2>‚úÖ 6. Propri√©t√©s de la Solution</h2>

        <div class="note" style="background: #e0f2f1; border-left-color: #009688;">
            <div class="note-title" style="color: #004d40;">üí° Pourquoi l'unicit√© est importante ?</div>
            <p><strong>Le probl√®me de la multiplicit√© :</strong> Si plusieurs solutions existaient, on ne saurait pas laquelle choisir, et les algorithmes pourraient converger vers diff√©rentes solutions selon les conditions initiales. Cela rendrait l'optimisation impr√©visible.</p>
            
            <p><strong>L'unicit√© garantit :</strong></p>
            <ul>
                <li>La solution trouv√©e est la <strong>vraie</strong> solution optimale (pas juste une parmi d'autres)</li>
                <li>Les algorithmes convergent toujours vers la <strong>m√™me</strong> solution</li>
                <li>On peut comparer diff√©rents portefeuilles de mani√®re fiable</li>
            </ul>
            
            <p><strong>Quand l'unicit√© est garantie ?</strong> Si $\boldsymbol{\Sigma}$ est <strong>d√©finie positive</strong> (et pas juste semi-d√©finie positive), alors la fonction objectif est <strong>strictement convexe</strong>, ce qui garantit l'unicit√©. En pratique, si deux actifs sont parfaitement corr√©l√©s, $\boldsymbol{\Sigma}$ peut √™tre singuli√®re (non inversible), et on doit appliquer une r√©gularisation.</p>
        </div>

        <div class="theorem">
            <div class="theorem-title">Th√©or√®me 6.1 : Unicit√© de la Solution</div>
            <p>Si $\boldsymbol{\Sigma}$ est <strong>d√©finie positive</strong>, alors la solution $\mathbf{w}^*$ est <strong>unique</strong>.</p>
        </div>

        <div class="proof">
            <div class="proof-title">Preuve :</div>
            <p>Si $\boldsymbol{\Sigma}$ est d√©finie positive, alors la fonction objectif $f(\mathbf{w}) = \mathbf{w}^T \boldsymbol{\Sigma} \mathbf{w}$ est <strong>strictement convexe</strong>.</p>
            <p>Pour une fonction strictement convexe sur un ensemble convexe, le minimum global est <strong>unique</strong>.</p>
        </div>

        <div class="theorem">
            <div class="theorem-title">Th√©or√®me 6.2 : Sensibilit√© aux Param√®tres</div>
            <p>La solution est continue et diff√©rentiable par rapport aux param√®tres $\boldsymbol{\mu}$ et $\boldsymbol{\Sigma}$.</p>
        </div>

        <h2>üéØ 7. Impl√©mentation Num√©rique</h2>

        <div class="note" style="background: #fff3e0; border-left-color: #ff9800;">
            <div class="note-title" style="color: #e65100;">üí° Pourquoi la r√©gularisation est n√©cessaire ?</div>
            <p><strong>Le probl√®me de la singularit√© :</strong> Si deux actifs sont parfaitement corr√©l√©s (ou presque), la matrice $\boldsymbol{\Sigma}$ peut √™tre <strong>singuli√®re</strong> (non inversible). Cela arrive quand :</p>
            <ul>
                <li>Deux actifs ont des rendements identiques (corr√©lation = 1)</li>
                <li>On a plus d'actifs que d'observations historiques</li>
                <li>Les donn√©es sont colin√©aires</li>
            </ul>
            
            <p><strong>La solution : r√©gularisation Ridge</strong> On ajoute $\lambda I$ √† la matrice de covariance : $\boldsymbol{\Sigma}_{\text{reg}} = \boldsymbol{\Sigma} + \lambda I$. Cela :</p>
            <ul>
                <li>Rend la matrice <strong>d√©finie positive</strong> (garantit l'inversibilit√©)</li>
                <li>R√©duit le bruit dans l'estimation (shrinkage vers l'identit√©)</li>
                <li>Stabilise la solution num√©rique</li>
            </ul>
            
            <p><strong>Le param√®tre $\lambda$ :</strong> Il contr√¥le le compromis entre fid√©lit√© aux donn√©es ($\lambda$ petit) et stabilit√© ($\lambda$ grand). En pratique, on choisit $\lambda$ petit (ex: 0.01) pour ne pas trop modifier la structure de covariance.</p>
        </div>

        <div class="note">
            <div class="note-title">Algorithme Pseudo-code :</div>
            <pre style="background: #f4f4f4; padding: 15px; border-radius: 5px; overflow-x: auto;">
<code>Fonction optimize_portfolio(Œº, Œ£, r_target, w_max):
    // 1. V√©rifier que Œ£ est d√©finie positive
    Si det(Œ£) ‚â§ 0:
        Appliquer r√©gularisation: Œ£ = Œ£ + ŒªI
    
    // 2. D√©finir les contraintes
    Contraintes = [
        w^T Œº = r_target,
        1^T w = 1,
        w ‚â• 0,
        w ‚â§ w_max
    ]
    
    // 3. R√©soudre le probl√®me QP
    w* = solve_qp(
        objectif: min w^T Œ£ w,
        contraintes: Contraintes
    )
    
    // 4. Calculer la variance optimale
    œÉ¬≤ = w*^T Œ£ w*
    
    Retourner (w*, œÉ¬≤)
</code></pre>
        </div>

        <h2>üìà 8. Exemple Num√©rique</h2>

        <div class="note" style="background: #e8eaf6; border-left-color: #3f51b5;">
            <div class="note-title" style="color: #1a237e;">üí° Interpr√©tation de l'exemple :</div>
            <p><strong>Les donn√©es :</strong> On a 3 actifs avec des rendements esp√©r√©s de 10%, 12% et 8%. La matrice de covariance montre que :</p>
            <ul>
                <li>L'actif 1 a une variance de 0.04 (√©cart-type 20%)</li>
                <li>L'actif 2 a une variance de 0.05 (√©cart-type 22.4%) - le plus risqu√© mais aussi le plus rentable</li>
                <li>L'actif 3 a une variance de 0.03 (√©cart-type 17.3%) - le moins risqu√© mais aussi le moins rentable</li>
                <li>Les corr√©lations sont positives mais mod√©r√©es (pas de corr√©lation parfaite)</li>
            </ul>
            
            <p><strong>La solution optimale :</strong> Pour un rendement cible de 10%, l'allocation optimale est :</p>
            <ul>
                <li>40% dans l'actif 1 (rendement 10%, risque mod√©r√©)</li>
                <li>50% dans l'actif 2 (rendement 12%, risque √©lev√© mais diversifi√©)</li>
                <li>10% dans l'actif 3 (rendement 8%, risque faible pour stabiliser)</li>
            </ul>
            
            <p><strong>Pourquoi cette allocation ?</strong> L'optimiseur trouve le meilleur compromis : il favorise l'actif 2 (le plus rentable) mais le diversifie avec les autres actifs pour r√©duire le risque total. Le r√©sultat est un portefeuille avec un rendement de 10% et un risque (√©cart-type) de 15.8%, ce qui est meilleur que n'importe quel portefeuille non optimis√© avec le m√™me rendement.</p>
        </div>

        <div class="formula">
            <p><strong>Exemple avec 3 actifs :</strong></p>
            $$
            \boldsymbol{\mu} = \begin{bmatrix} 0.10 \\ 0.12 \\ 0.08 \end{bmatrix}, \quad
            \boldsymbol{\Sigma} = \begin{bmatrix}
            0.04 & 0.01 & 0.005 \\
            0.01 & 0.05 & 0.01 \\
            0.005 & 0.01 & 0.03
            \end{bmatrix}, \quad
            r_{\text{target}} = 0.10
            $$
        </div>

        <div class="proof">
            <div class="proof-title">Calcul :</div>
            <p>En utilisant la formule analytique (cas sans contraintes de bornes) :</p>
            $$
            \begin{aligned}
            A &= 0.25, \quad B = 0.20, \quad C = 0.18 \\
            AC - B^2 &= 0.005 \\
            \lambda_1 &= 0.4, \quad \lambda_2 = 0.2 \\
            \mathbf{w}^* &= \begin{bmatrix} 0.40 \\ 0.50 \\ 0.10 \end{bmatrix}
            \end{aligned}
            $$
            <p>Variance optimale : $\sigma^2 = 0.025$ (√©cart-type : $\sigma = 0.158$)</p>
        </div>

        <hr style="margin: 60px 0; border: none; border-top: 3px solid #667eea;">

        <h1 style="color: #667eea; text-align: center; margin-top: 60px; margin-bottom: 30px; font-size: 2.2em; border-bottom: 3px solid #667eea; padding-bottom: 15px;">
            üìö CHAPITRES AVANC√âS
        </h1>

        <h2>üéØ CHAPITRE 9 : Conditional Value at Risk (CVaR)</h2>

        <div class="note" style="background: #fff3e0; border-left-color: #ff9800;">
            <div class="note-title" style="color: #e65100;">üí° Pourquoi le CVaR au lieu de la variance ?</div>
            <p><strong>Le probl√®me de la variance :</strong> La variance mesure la <strong>volatilit√© globale</strong> des rendements, mais elle traite de la m√™me mani√®re les gains et les pertes. Or, en finance, on se pr√©occupe surtout des <strong>pertes extr√™mes</strong> (le "tail risk").</p>
            
            <p><strong>Exemple concret :</strong> Un portefeuille avec des rendements tr√®s variables mais toujours positifs a une grande variance, mais ne pr√©sente pas vraiment de risque de perte. Inversement, un portefeuille avec des rendements stables mais occasionnellement tr√®s n√©gatifs peut avoir une variance mod√©r√©e mais un risque r√©el √©lev√©.</p>
            
            <p><strong>Le CVaR r√©pond √† cette limitation :</strong> Le Conditional Value at Risk (aussi appel√© Expected Shortfall) se concentre sp√©cifiquement sur les <strong>pertes extr√™mes</strong> - les pires sc√©narios. Il r√©pond √† la question : "Si on subit une perte importante, quelle est la perte moyenne dans ces cas-l√† ?"</p>
            
            <p><strong>Pourquoi c'est mieux pour le risk management ?</strong></p>
            <ul>
                <li><strong>Focus sur les pertes :</strong> Le CVaR ne regarde que la queue gauche de la distribution (les pertes)</li>
                <li><strong>Mesure coh√©rente :</strong> Le CVaR est une mesure de risque "coh√©rente" (satisfait des propri√©t√©s math√©matiques importantes)</li>
                <li><strong>R√©glementation :</strong> De nombreux r√©gulateurs (B√¢le III, Solvabilit√© II) utilisent le CVaR pour √©valuer le risque</li>
                <li><strong>Protection contre les crises :</strong> Le CVaR capture mieux le risque de crise que la variance</li>
            </ul>
            
            <p><strong>Le lien avec la VaR :</strong> La Value at Risk (VaR) mesure la perte maximale avec une probabilit√© donn√©e (ex: "avec 95% de confiance, on ne perdra pas plus de 5%"). Le CVaR va plus loin : "Si on d√©passe la VaR, quelle est la perte moyenne ?" C'est plus conservateur et informatif.</p>
        </div>

        <div class="definition">
            <div class="definition-title">D√©finition 9.1 : Value at Risk (VaR)</div>
            <p>La Value at Risk au niveau de confiance $\alpha$ (ex: $\alpha = 0.95$ pour 95%) est le quantile $(1-\alpha)$ de la distribution des rendements :</p>
            $$
            \text{VaR}_\alpha = -F^{-1}(1-\alpha)
            $$
            <p>o√π $F$ est la fonction de r√©partition des rendements. En d'autres termes, avec probabilit√© $\alpha$, les pertes ne d√©passeront pas $\text{VaR}_\alpha$.</p>
        </div>

        <div class="definition">
            <div class="definition-title">D√©finition 9.2 : Conditional Value at Risk (CVaR)</div>
            <p>Le Conditional Value at Risk (ou Expected Shortfall) est l'esp√©rance conditionnelle des pertes sachant qu'on d√©passe la VaR :</p>
            $$
            \text{CVaR}_\alpha = \mathbb{E}[R | R \leq -\text{VaR}_\alpha] = \frac{1}{1-\alpha} \int_{-\infty}^{-\text{VaR}_\alpha} r \cdot f(r) \, dr
            $$
            <p>o√π $f$ est la densit√© de probabilit√© des rendements. Le CVaR mesure donc la <strong>perte moyenne dans les pires cas</strong> (les $(1-\alpha) \times 100\%$ pires sc√©narios).</p>
        </div>

        <div class="note" style="background: #e8f5e9; border-left-color: #4caf50;">
            <div class="note-title" style="color: #2e7d32;">üîó Interpr√©tation intuitive du CVaR :</div>
            <p>Si $\alpha = 0.95$ (95% de confiance) :</p>
            <ul>
                <li><strong>VaR‚ÇÄ.‚Çâ‚ÇÖ :</strong> "Dans 95% des cas, on ne perdra pas plus de X%"</li>
                <li><strong>CVaR‚ÇÄ.‚Çâ‚ÇÖ :</strong> "Dans les 5% pires cas, la perte moyenne sera de Y%"</li>
            </ul>
            <p><strong>Exemple concret :</strong> Si CVaR‚ÇÄ.‚Çâ‚ÇÖ = 10%, cela signifie que dans les 5% pires sc√©narios (crises, krachs), on perdra en moyenne 10% du portefeuille. C'est beaucoup plus informatif que la VaR qui ne dit que "on ne perdra pas plus de X% dans 95% des cas".</p>
        </div>

        <h3>9.1 Formulation du Probl√®me d'Optimisation sous CVaR</h3>

        <div class="formula">
            <p><strong>Probl√®me d'optimisation :</strong></p>
            $$
            \begin{aligned}
            \min_{\mathbf{w}} \quad & \text{CVaR}_\alpha(\mathbf{w}) \\
            \text{s.t.} \quad & \mathbf{w}^T \boldsymbol{\mu} = r_{\text{target}} \\
            & \mathbf{1}^T \mathbf{w} = 1 \\
            & \mathbf{w} \geq \mathbf{0} \\
            & \text{CVaR}_\alpha(\mathbf{w}) \leq \text{CVaR}_{\max}
            \end{aligned}
            $$
        </div>

        <div class="proof">
            <div class="proof-title">Formulation Lin√©aire du CVaR (Rockafellar & Uryasev, 2002) :</div>
            
            <p><strong>L'id√©e cl√© :</strong> Le CVaR peut √™tre reformul√© comme un probl√®me d'optimisation lin√©aire en introduisant des variables auxiliaires. C'est crucial car cela permet d'utiliser des solveurs efficaces.</p>
            
            <div class="step">
                <span class="step-number">1</span>
                <strong>Formulation avec variable auxiliaire :</strong>
            </div>
            <p>On introduit une variable $t$ (qui repr√©sente la VaR) et des variables $u_i$ pour chaque sc√©nario $i$ :</p>
            $$
            \text{CVaR}_\alpha = \min_{t} \left\{ t + \frac{1}{1-\alpha} \mathbb{E}[\max(0, -R - t)] \right\}
            $$
            <p><strong>Pourquoi cette formulation ?</strong> Cette reformulation transforme le probl√®me non-lin√©aire (bas√© sur des quantiles) en un probl√®me lin√©aire, beaucoup plus facile √† r√©soudre.</p>
            
            <div class="step">
                <span class="step-number">2</span>
                <strong>Formulation discr√®te (avec sc√©narios) :</strong>
            </div>
            <p>En pratique, on utilise des sc√©narios historiques ou simul√©s. Si on a $S$ sc√©narios avec rendements $r_s$ et probabilit√©s $p_s$ :</p>
            $$
            \begin{aligned}
            \min_{\mathbf{w}, t, \mathbf{u}} \quad & t + \frac{1}{1-\alpha} \sum_{s=1}^{S} p_s u_s \\
            \text{s.t.} \quad & u_s \geq -\mathbf{w}^T \mathbf{r}_s - t, \quad \forall s \\
            & u_s \geq 0, \quad \forall s \\
            & \mathbf{w}^T \boldsymbol{\mu} = r_{\text{target}} \\
            & \mathbf{1}^T \mathbf{w} = 1 \\
            & \mathbf{w} \geq \mathbf{0}
            \end{aligned}
            $$
            <p><strong>Intuition :</strong> Les variables $u_s$ capturent les "exc√®s de perte" au-del√† du seuil $t$ (la VaR). On minimise la somme pond√©r√©e de ces exc√®s, ce qui donne le CVaR.</p>
        </div>

        <div class="note" style="background: #e1f5fe; border-left-color: #0288d1;">
            <div class="note-title" style="color: #01579b;">üí° Pourquoi cette formulation est puissante ?</div>
            <p><strong>Avantages de la formulation lin√©aire :</strong></p>
            <ul>
                <li><strong>Efficacit√© :</strong> Les solveurs lin√©aires sont tr√®s rapides (simplex, point int√©rieur)</li>
                <li><strong>Scalabilit√© :</strong> On peut traiter des milliers de sc√©narios facilement</li>
                <li><strong>Robustesse :</strong> Pas de probl√®mes de convergence comme avec les m√©thodes non-lin√©aires</li>
                <li><strong>Flexibilit√© :</strong> On peut ajouter facilement d'autres contraintes lin√©aires</li>
            </ul>
            
            <p><strong>Le lien avec la variance :</strong> La variance p√©nalise toutes les d√©viations (positives et n√©gatives). Le CVaR ne p√©nalise que les pertes extr√™mes. C'est pourquoi l'optimisation CVaR peut donner des portefeuilles diff√©rents (et souvent meilleurs pour le risk management) que l'optimisation variance.</p>
        </div>

        <h3>9.2 Comparaison Variance vs CVaR</h3>

        <div class="theorem">
            <div class="theorem-title">Th√©or√®me 9.1 : Propri√©t√©s du CVaR</div>
            <p>Le CVaR est une <strong>mesure de risque coh√©rente</strong>, c'est-√†-dire qu'il satisfait :</p>
            <ol>
                <li><strong>Monotonie :</strong> Si $R_1 \geq R_2$ (presque s√ªrement), alors $\text{CVaR}_\alpha(R_1) \leq \text{CVaR}_\alpha(R_2)$</li>
                <li><strong>Sous-additivit√© :</strong> $\text{CVaR}_\alpha(R_1 + R_2) \leq \text{CVaR}_\alpha(R_1) + \text{CVaR}_\alpha(R_2)$</li>
                <li><strong>Homog√©n√©it√© positive :</strong> $\text{CVaR}_\alpha(\lambda R) = \lambda \text{CVaR}_\alpha(R)$ pour $\lambda \geq 0$</li>
                <li><strong>Invariance par translation :</strong> $\text{CVaR}_\alpha(R + c) = \text{CVaR}_\alpha(R) - c$</li>
            </ol>
        </div>

        <div class="note" style="background: #f3e5f5; border-left-color: #9c27b0;">
            <div class="note-title" style="color: #6a1b9a;">üí° Pourquoi ces propri√©t√©s sont importantes ?</div>
            <p><strong>La sous-additivit√© (propri√©t√© 2) :</strong> C'est la propri√©t√© de <strong>diversification</strong> ! Elle dit que le risque d'un portefeuille combin√© est inf√©rieur ou √©gal √† la somme des risques individuels. C'est exactement ce qu'on veut : la diversification r√©duit le risque.</p>
            
            <p><strong>Comparaison avec la variance :</strong> La variance satisfait aussi la sous-additivit√© (gr√¢ce aux covariances), mais le CVaR le fait de mani√®re plus directe et intuitive pour les pertes extr√™mes.</p>
            
            <p><strong>Impact pratique :</strong> Ces propri√©t√©s garantissent que l'optimisation CVaR donnera des r√©sultats coh√©rents et interpr√©tables, ce qui est crucial pour le risk management institutionnel.</p>
        </div>

        <hr style="margin: 40px 0; border: none; border-top: 2px solid #ddd;">

        <h2>üõ°Ô∏è CHAPITRE 10 : Optimisation Robuste</h2>

        <div class="note" style="background: #fff3e0; border-left-color: #ff9800;">
            <div class="note-title" style="color: #e65100;">üí° Pourquoi l'optimisation robuste ?</div>
            <p><strong>Le probl√®me fondamental :</strong> En optimisation de portefeuille classique, on suppose que les param√®tres ($\boldsymbol{\mu}$ et $\boldsymbol{\Sigma}$) sont <strong>connus avec certitude</strong>. En r√©alit√©, ces param√®tres sont <strong>estim√©s</strong> √† partir de donn√©es historiques et sont donc <strong>incertains</strong>.</p>
            
            <p><strong>Le probl√®me de l'estimation :</strong></p>
            <ul>
                <li>Les rendements futurs peuvent diff√©rer des rendements historiques</li>
                <li>Les corr√©lations changent dans le temps (surtout en p√©riode de crise)</li>
                <li>Les estimations sont bruit√©es (erreur d'√©chantillonnage)</li>
                <li>Un portefeuille optimal avec des param√®tres estim√©s peut √™tre tr√®s mauvais avec les vrais param√®tres</li>
            </ul>
            
            <p><strong>Exemple concret :</strong> Si on optimise avec une estimation de $\boldsymbol{\Sigma}$ qui sous-estime certaines corr√©lations, le portefeuille optimal peut √™tre trop concentr√© et tr√®s risqu√© si les vraies corr√©lations sont plus √©lev√©es.</p>
            
            <p><strong>La solution : optimisation robuste</strong> Au lieu d'optimiser avec des param√®tres fixes, on optimise en supposant que les param√®tres peuvent varier dans un <strong>ensemble d'incertitude</strong>. On cherche le portefeuille qui est optimal m√™me dans le pire cas.</p>
            
            <p><strong>Philosophie :</strong> "Mieux vaut un portefeuille qui fonctionne bien dans tous les sc√©narios qu'un portefeuille optimal dans un sc√©nario mais catastrophique dans d'autres."</p>
        </div>

        <div class="definition">
            <div class="definition-title">D√©finition 10.1 : Optimisation Robuste (Min-Max)</div>
            <p>L'optimisation robuste cherche √† minimiser le risque dans le pire cas possible des param√®tres :</p>
            $$
            \min_{\mathbf{w}} \max_{\boldsymbol{\Sigma} \in \mathcal{U}} \mathbf{w}^T \boldsymbol{\Sigma} \mathbf{w}
            $$
            <p>o√π $\mathcal{U}$ est l'<strong>ensemble d'incertitude</strong> sur la matrice de covariance. On cherche donc le portefeuille qui minimise la variance <strong>m√™me si</strong> la vraie covariance est la pire possible dans l'ensemble $\mathcal{U}$.</p>
        </div>

        <div class="note" style="background: #e8f5e9; border-left-color: #4caf50;">
            <div class="note-title" style="color: #2e7d32;">üîó Interpr√©tation intuitive :</div>
            <p><strong>Optimisation classique :</strong> "Trouve le portefeuille optimal en supposant que $\boldsymbol{\Sigma}$ est exactement ce qu'on a estim√©."</p>
            <p><strong>Optimisation robuste :</strong> "Trouve le portefeuille qui fonctionne le mieux m√™me si $\boldsymbol{\Sigma}$ est diff√©rente de ce qu'on a estim√© (dans certaines limites)."</p>
            <p>C'est une approche <strong>conservatrice</strong> mais <strong>robuste</strong> aux erreurs d'estimation.</p>
        </div>

        <h3>10.1 Ensemble d'Incertitude Ellipso√Ødal</h3>

        <div class="formula">
            <p><strong>Ensemble d'incertitude ellipso√Ødal :</strong></p>
            $$
            \mathcal{U} = \left\{ \boldsymbol{\Sigma} : \|\boldsymbol{\Sigma} - \boldsymbol{\Sigma}_0\|_F \leq \rho \right\}
            $$
            <p>o√π $\boldsymbol{\Sigma}_0$ est l'estimation de base, $\|\cdot\|_F$ est la norme de Frobenius, et $\rho$ est le <strong>rayon d'incertitude</strong>.</p>
        </div>

        <div class="proof">
            <div class="proof-title">R√©solution du Probl√®me Min-Max :</div>
            
            <div class="step">
                <span class="step-number">1</span>
                <strong>Formulation du probl√®me :</strong>
            </div>
            $$
            \begin{aligned}
            \min_{\mathbf{w}} \quad & \max_{\boldsymbol{\Sigma} \in \mathcal{U}} \mathbf{w}^T \boldsymbol{\Sigma} \mathbf{w} \\
            \text{s.t.} \quad & \mathbf{w}^T \boldsymbol{\mu} = r_{\text{target}} \\
            & \mathbf{1}^T \mathbf{w} = 1 \\
            & \mathbf{w} \geq \mathbf{0}
            \end{aligned}
            $$
            
            <div class="step">
                <span class="step-number">2</span>
                <strong>R√©solution du probl√®me interne (max) :</strong>
            </div>
            <p>Pour un $\mathbf{w}$ fix√©, on cherche $\boldsymbol{\Sigma}^*$ qui maximise $\mathbf{w}^T \boldsymbol{\Sigma} \mathbf{w}$ dans $\mathcal{U}$.</p>
            <p>Par la dualit√©, on peut montrer que :</p>
            $$
            \max_{\boldsymbol{\Sigma} \in \mathcal{U}} \mathbf{w}^T \boldsymbol{\Sigma} \mathbf{w} = \mathbf{w}^T \boldsymbol{\Sigma}_0 \mathbf{w} + \rho \|\mathbf{w}\|_2^2
            $$
            <p><strong>Intuition :</strong> Le pire cas est atteint quand on ajoute le maximum d'incertitude ($\rho$) pond√©r√© par la norme du portefeuille.</p>
            
            <div class="step">
                <span class="step-number">3</span>
                <strong>Probl√®me externe (min) :</strong>
            </div>
            <p>Le probl√®me devient :</p>
            $$
            \begin{aligned}
            \min_{\mathbf{w}} \quad & \mathbf{w}^T \boldsymbol{\Sigma}_0 \mathbf{w} + \rho \|\mathbf{w}\|_2^2 \\
            \text{s.t.} \quad & \mathbf{w}^T \boldsymbol{\mu} = r_{\text{target}} \\
            & \mathbf{1}^T \mathbf{w} = 1 \\
            & \mathbf{w} \geq \mathbf{0}
            \end{aligned}
            $$
            <p><strong>Interpr√©tation :</strong> On minimise la variance estim√©e <strong>plus</strong> un terme de p√©nalisation qui augmente avec la concentration du portefeuille. Cela favorise naturellement la <strong>diversification</strong> !</p>
        </div>

        <div class="note" style="background: #e1f5fe; border-left-color: #0288d1;">
            <div class="note-title" style="color: #01579b;">üí° Pourquoi cette solution favorise la diversification ?</div>
            <p><strong>Le terme $\rho \|\mathbf{w}\|_2^2$ :</strong> Ce terme est grand quand le portefeuille est concentr√© (peu d'actifs avec des poids √©lev√©s) et petit quand il est diversifi√© (beaucoup d'actifs avec des poids mod√©r√©s).</p>
            
            <p><strong>Exemple :</strong> Si on a 10% dans chaque actif (10 actifs), $\|\mathbf{w}\|_2^2 = 0.1$. Si on a 100% dans un actif, $\|\mathbf{w}\|_2^2 = 1$. Le terme de p√©nalisation est donc 10 fois plus grand pour le portefeuille concentr√©.</p>
            
            <p><strong>R√©sultat :</strong> L'optimisation robuste produit naturellement des portefeuilles plus diversifi√©s, ce qui est exactement ce qu'on veut pour r√©duire le risque d'estimation !</p>
        </div>

        <h3>10.2 Choix du Rayon d'Incertitude $\rho$</h3>

        <div class="note" style="background: #f3e5f5; border-left-color: #9c27b0;">
            <div class="note-title" style="color: #6a1b9a;">üí° Comment choisir $\rho$ ?</div>
            <p><strong>Le compromis :</strong></p>
            <ul>
                <li><strong>$\rho$ petit :</strong> On fait confiance √† notre estimation. Le portefeuille est proche de l'optimisation classique, mais moins robuste.</li>
                <li><strong>$\rho$ grand :</strong> On est tr√®s conservateur. Le portefeuille est tr√®s diversifi√© et robuste, mais peut √™tre sous-optimal si notre estimation est bonne.</li>
            </ul>
            
            <p><strong>M√©thodes de choix :</strong></p>
            <ol>
                <li><strong>Bootstrap :</strong> Estimer $\rho$ √† partir de la variabilit√© des estimations sur des √©chantillons bootstrap</li>
                <li><strong>Validation crois√©e :</strong> Choisir $\rho$ qui maximise la performance hors √©chantillon</li>
                <li><strong>R√®gle empirique :</strong> $\rho = 0.1 \times \|\boldsymbol{\Sigma}_0\|_F$ (10% d'incertitude)</li>
            </ol>
        </div>

        <hr style="margin: 40px 0; border: none; border-top: 2px solid #ddd;">

        <h2>üìä CHAPITRE 11 : Estimation Robuste de Covariance (Ledoit-Wolf)</h2>

        <div class="note" style="background: #fff3e0; border-left-color: #ff9800;">
            <div class="note-title" style="color: #e65100;">üí° Pourquoi am√©liorer l'estimation de covariance ?</div>
            <p><strong>Le probl√®me de l'estimation na√Øve :</strong> L'estimateur classique de covariance est :</p>
            $$
            \hat{\boldsymbol{\Sigma}} = \frac{1}{T-1} \sum_{t=1}^{T} (\mathbf{r}_t - \bar{\mathbf{r}})(\mathbf{r}_t - \bar{\mathbf{r}})^T
            $$
            <p>o√π $T$ est le nombre d'observations et $\mathbf{r}_t$ sont les rendements.</p>
            
            <p><strong>Probl√®mes de cet estimateur :</strong></p>
            <ul>
                <li><strong>Bruit d'estimation :</strong> Avec peu d'observations ($T$ petit) ou beaucoup d'actifs ($n$ grand), l'estimation est tr√®s bruit√©e</li>
                <li><strong>Instabilit√© :</strong> De petites variations dans les donn√©es peuvent causer de grandes variations dans $\hat{\boldsymbol{\Sigma}}$</li>
                <li><strong>Singularit√© :</strong> Si $T < n$, la matrice est singuli√®re (non inversible), ce qui pose probl√®me pour l'optimisation</li>
                <li><strong>Mauvaise performance :</strong> Les portefeuilles optimis√©s avec $\hat{\boldsymbol{\Sigma}}$ bruit√©e ont souvent une mauvaise performance hors √©chantillon</li>
            </ul>
            
            <p><strong>Exemple concret :</strong> Si on a 100 actifs mais seulement 50 observations mensuelles, on estime $100 \times 101 / 2 = 5050$ param√®tres (covariances) avec seulement 50 observations. C'est beaucoup trop !</p>
            
            <p><strong>La solution : Shrinkage de Ledoit-Wolf</strong> On "r√©tr√©cit" l'estimation vers une cible plus stable (comme la matrice identit√©), r√©duisant ainsi le bruit tout en pr√©servant la structure importante.</p>
        </div>

        <div class="definition">
            <div class="definition-title">D√©finition 11.1 : Shrinkage de Ledoit-Wolf</div>
            <p>L'estimateur de Ledoit-Wolf combine l'estimation de l'√©chantillon avec une cible (g√©n√©ralement la matrice identit√©) :</p>
            $$
            \hat{\boldsymbol{\Sigma}}_{\text{LW}} = \alpha \hat{\boldsymbol{\Sigma}}_{\text{sample}} + (1-\alpha) \hat{\boldsymbol{\Sigma}}_{\text{target}}
            $$
            <p>o√π $\alpha \in [0,1]$ est le <strong>coefficient de shrinkage</strong>, choisi pour minimiser l'erreur quadratique moyenne.</p>
        </div>

        <div class="note" style="background: #e8f5e9; border-left-color: #4caf50;">
            <div class="note-title" style="color: #2e7d32;">üîó Intuition du Shrinkage :</div>
            <p><strong>L'id√©e :</strong> Au lieu d'utiliser directement l'estimation bruit√©e $\hat{\boldsymbol{\Sigma}}_{\text{sample}}$, on fait une moyenne pond√©r√©e avec une cible plus stable $\hat{\boldsymbol{\Sigma}}_{\text{target}}$ (souvent $I$ ou une matrice diagonale).</p>
            
            <p><strong>Pourquoi √ßa marche ?</strong></p>
            <ul>
                <li>L'estimation de l'√©chantillon capture la <strong>structure r√©elle</strong> mais avec du <strong>bruit</strong></li>
                <li>La cible est <strong>stable</strong> mais peut √™tre <strong>biais√©e</strong> (ne capture pas les corr√©lations)</li>
                <li>Le shrinkage trouve le <strong>meilleur compromis</strong> entre ces deux extr√™mes</li>
            </ul>
            
            <p><strong>Le coefficient $\alpha$ :</strong> Si $\alpha$ est proche de 1, on fait confiance √† l'√©chantillon (beaucoup de donn√©es). Si $\alpha$ est proche de 0, on fait confiance √† la cible (peu de donn√©es, beaucoup de bruit).</p>
        </div>

        <div class="proof">
            <div class="proof-title">D√©rivation du Coefficient Optimal $\alpha$ :</div>
            
            <div class="step">
                <span class="step-number">1</span>
                <strong>Crit√®re d'optimisation :</strong>
            </div>
            <p>On cherche $\alpha$ qui minimise l'erreur quadratique moyenne (MSE) :</p>
            $$
            \text{MSE}(\alpha) = \mathbb{E}\left[ \|\hat{\boldsymbol{\Sigma}}_{\text{LW}} - \boldsymbol{\Sigma}_{\text{true}}\|_F^2 \right]
            $$
            
            <div class="step">
                <span class="step-number">2</span>
                <strong>D√©composition du biais et de la variance :</strong>
            </div>
            <p>Le MSE se d√©compose en :</p>
            $$
            \text{MSE} = \text{Biais}^2 + \text{Variance}
            $$
            <p>o√π :</p>
            <ul>
                <li><strong>Biais :</strong> L'estimation de l'√©chantillon a un biais faible mais une variance √©lev√©e</li>
                <li><strong>Variance :</strong> La cible a un biais potentiel mais une variance faible</li>
            </ul>
            
            <div class="step">
                <span class="step-number">3</span>
                <strong>Solution optimale :</strong>
            </div>
            <p>Ledoit & Wolf (2004) montrent que le $\alpha$ optimal est :</p>
            $$
            \alpha^* = \frac{\sum_{i,j} \text{Var}(\hat{\Sigma}_{ij})}{\sum_{i,j} [\hat{\Sigma}_{ij} - \Sigma_{\text{target},ij}]^2 + \text{Var}(\hat{\Sigma}_{ij})}
            $$
            <p><strong>Interpr√©tation :</strong> Si la variance de l'estimation est grande (beaucoup de bruit), $\alpha^*$ est petit (on fait plus confiance √† la cible). Si l'estimation est proche de la cible, $\alpha^*$ est grand (on fait confiance √† l'√©chantillon).</p>
        </div>

        <h3>11.1 Choix de la Cible</h3>

        <div class="note" style="background: #e1f5fe; border-left-color: #0288d1;">
            <div class="note-title" style="color: #01579b;">üí° Diff√©rentes cibles possibles :</div>
            <p><strong>1. Matrice Identit√© ($I$) :</strong></p>
            <ul>
                <li>Simple et stable</li>
                <li>Suppose que les actifs sont ind√©pendants (corr√©lations nulles)</li>
                <li>Bonne quand les corr√©lations sont faibles ou mal estim√©es</li>
            </ul>
            
            <p><strong>2. Matrice Diagonale (variances seulement) :</strong></p>
            <ul>
                <li>Conserve les variances individuelles (estim√©es mieux que les covariances)</li>
                <li>Suppose des corr√©lations nulles</li>
                <li>Meilleure que l'identit√© si les variances sont bien estim√©es</li>
            </ul>
            
            <p><strong>3. Mod√®le √† un facteur (Single Index Model) :</strong></p>
            <ul>
                <li>$\boldsymbol{\Sigma}_{\text{target}} = \sigma_m^2 \boldsymbol{\beta} \boldsymbol{\beta}^T + \mathbf{D}$</li>
                <li>O√π $\boldsymbol{\beta}$ sont les b√™tas (sensibilit√© au march√©) et $\mathbf{D}$ est diagonal</li>
                <li>Capture la structure de corr√©lation via le facteur de march√©</li>
            </ul>
            
            <p><strong>4. Mod√®le √† facteurs multiples (Fama-French) :</strong></p>
            <ul>
                <li>Extension du mod√®le √† un facteur avec plusieurs facteurs</li>
                <li>Plus sophistiqu√© mais n√©cessite plus de donn√©es</li>
            </ul>
        </div>

        <h3>11.2 Avantages du Shrinkage</h3>

        <div class="theorem">
            <div class="theorem-title">Th√©or√®me 11.1 : Propri√©t√©s du Shrinkage</div>
            <p>L'estimateur de Ledoit-Wolf :</p>
            <ol>
                <li><strong>R√©duit le bruit :</strong> La variance de l'estimation est r√©duite</li>
                <li><strong>Am√©liore la condition :</strong> Le conditionnement de la matrice est am√©lior√© (plus stable num√©riquement)</li>
                <li><strong>Meilleure performance hors √©chantillon :</strong> Les portefeuilles optimis√©s avec $\hat{\boldsymbol{\Sigma}}_{\text{LW}}$ ont g√©n√©ralement une meilleure performance r√©elle</li>
                <li><strong>Garde la structure :</strong> Les corr√©lations importantes sont pr√©serv√©es</li>
            </ol>
        </div>

        <div class="note" style="background: #f3e5f5; border-left-color: #9c27b0;">
            <div class="note-title" style="color: #6a1b9a;">üí° Pourquoi le shrinkage am√©liore la performance ?</div>
            <p><strong>Le probl√®me de l'overfitting :</strong> L'estimation de l'√©chantillon peut "surapprendre" les donn√©es historiques, capturant du bruit comme s'il s'agissait de structure r√©elle. Quand on optimise avec cette matrice bruit√©e, le portefeuille est optimis√© pour le bruit historique, pas pour la vraie structure.</p>
            
            <p><strong>La solution du shrinkage :</strong> En r√©duisant le bruit, on se concentre sur la structure r√©elle. Le portefeuille optimis√© est donc plus robuste et performe mieux sur de nouvelles donn√©es.</p>
            
            <p><strong>Exemple :</strong> Si deux actifs ont une corr√©lation historiquement √©lev√©e due au hasard (bruit), l'estimation de l'√©chantillon va capturer cela. Le shrinkage va r√©duire cette corr√©lation artificielle, √©vitant une mauvaise allocation.</p>
        </div>

        <hr style="margin: 40px 0; border: none; border-top: 2px solid #ddd;">

        <h2>üåÄ CHAPITRE 12 : Copules pour Stress Testing</h2>

        <div class="note" style="background: #fff3e0; border-left-color: #ff9800;">
            <div class="note-title" style="color: #e65100;">üí° Pourquoi les copules pour le stress testing ?</div>
            <p><strong>Le probl√®me de la corr√©lation lin√©aire :</strong> La corr√©lation de Pearson (utilis√©e dans $\boldsymbol{\Sigma}$) mesure seulement la <strong>d√©pendance lin√©aire</strong>. Elle ne capture pas :</p>
            <ul>
                <li>Les <strong>d√©pendances non-lin√©aires</strong> (ex: deux actifs qui bougent ensemble seulement en p√©riode de crise)</li>
                <li>Les <strong>d√©pendances asym√©triques</strong> (la corr√©lation peut √™tre diff√©rente en hausse vs en baisse)</li>
                <li>Les <strong>d√©pendances extr√™mes</strong> (les corr√©lations peuvent augmenter drastiquement en p√©riode de stress)</li>
            </ul>
            
            <p><strong>Exemple concret :</strong> En p√©riode normale, deux actions peuvent avoir une corr√©lation de 0.3. Mais en p√©riode de crise (krach), cette corr√©lation peut monter √† 0.9 (tout baisse ensemble). La corr√©lation moyenne ne capture pas cette dynamique.</p>
            
            <p><strong>Le probl√®me pour le stress testing :</strong> Pour tester la r√©sistance d'un portefeuille √† des sc√©narios extr√™mes, on a besoin de mod√©liser correctement les <strong>d√©pendances en p√©riode de stress</strong>. C'est exactement ce que font les copules !</p>
            
            <p><strong>La solution : Copules</strong> Les copules permettent de mod√©liser s√©par√©ment :</p>
            <ol>
                <li>Les <strong>distributions marginales</strong> de chaque actif (comment chaque actif se comporte individuellement)</li>
                <li>La <strong>structure de d√©pendance</strong> entre les actifs (comment ils bougent ensemble)</li>
            </ol>
            <p>Cette s√©paration permet de mod√©liser des d√©pendances complexes et non-lin√©aires, particuli√®rement importantes pour les sc√©narios de stress.</p>
        </div>

        <div class="definition">
            <div class="definition-title">D√©finition 12.1 : Copule (Th√©or√®me de Sklar)</div>
            <p>Selon le th√©or√®me de Sklar, toute fonction de r√©partition multivari√©e $F(x_1, \ldots, x_n)$ peut √™tre d√©compos√©e en :</p>
            $$
            F(x_1, \ldots, x_n) = C(F_1(x_1), \ldots, F_n(x_n))
            $$
            <p>o√π :</p>
            <ul>
                <li>$F_i$ sont les fonctions de r√©partition <strong>marginales</strong> (distributions individuelles)</li>
                <li>$C$ est la <strong>copule</strong> (structure de d√©pendance)</li>
            </ul>
            <p>La copule $C$ est une fonction de r√©partition sur $[0,1]^n$ avec des marginales uniformes.</p>
        </div>

        <div class="note" style="background: #e8f5e9; border-left-color: #4caf50;">
            <div class="note-title" style="color: #2e7d32;">üîó Intuition de la copule :</div>
            <p><strong>L'id√©e fondamentale :</strong> Au lieu de mod√©liser directement la distribution jointe (complexe), on mod√©lise s√©par√©ment :</p>
            <ol>
                <li><strong>Comment chaque actif se comporte seul</strong> (marginales) - ex: "L'actif A suit une distribution normale avec moyenne 10% et √©cart-type 15%"</li>
                <li><strong>Comment les actifs bougent ensemble</strong> (copule) - ex: "Quand l'actif A baisse de plus de 20%, l'actif B baisse aussi de plus de 20% avec probabilit√© 0.8"</li>
            </ol>
            
            <p><strong>Avantage :</strong> On peut choisir des marginales complexes (distributions avec queues √©paisses, asym√©trie) et une copule qui capture les d√©pendances extr√™mes, ind√©pendamment.</p>
        </div>

        <h3>12.1 Copule Gaussienne</h3>

        <div class="formula">
            <p><strong>Copule Gaussienne :</strong></p>
            <p>La copule Gaussienne utilise une structure de d√©pendance bas√©e sur la corr√©lation normale :</p>
            $$
            C_{\text{Gauss}}(u_1, \ldots, u_n; \mathbf{R}) = \Phi_{\mathbf{R}}(\Phi^{-1}(u_1), \ldots, \Phi^{-1}(u_n))
            $$
            <p>o√π :</p>
            <ul>
                <li>$u_i = F_i(x_i)$ sont les probabilit√©s transform√©es (uniforme sur [0,1])</li>
                <li>$\Phi$ est la fonction de r√©partition normale standard</li>
                <li>$\Phi_{\mathbf{R}}$ est la fonction de r√©partition normale multivari√©e avec matrice de corr√©lation $\mathbf{R}$</li>
            </ul>
        </div>

        <div class="note" style="background: #e1f5fe; border-left-color: #0288d1;">
            <div class="note-title" style="color: #01579b;">üí° Caract√©ristiques de la copule Gaussienne :</div>
            <p><strong>Avantages :</strong></p>
            <ul>
                <li>Simple √† impl√©menter et comprendre</li>
                <li>Param√®tre unique : la matrice de corr√©lation $\mathbf{R}$</li>
                <li>Bonne approximation si les d√©pendances sont mod√©r√©es</li>
            </ul>
            
            <p><strong>Limitations :</strong></p>
            <ul>
                <li><strong>D√©pendance sym√©trique :</strong> La d√©pendance est la m√™me en hausse et en baisse</li>
                <li><strong>Pas de d√©pendance extr√™me :</strong> Ne capture pas bien l'augmentation des corr√©lations en p√©riode de stress</li>
                <li><strong>Queues fines :</strong> Sous-estime la probabilit√© d'√©v√©nements extr√™mes simultan√©s</li>
            </ul>
            
            <p><strong>Quand l'utiliser :</strong> Pour des sc√©narios de stress mod√©r√©s ou quand on veut une approximation simple.</p>
        </div>

        <h3>12.2 Copule t-Student</h3>

        <div class="formula">
            <p><strong>Copule t-Student :</strong></p>
            $$
            C_{\text{t}}(u_1, \ldots, u_n; \mathbf{R}, \nu) = t_{\mathbf{R},\nu}(t_\nu^{-1}(u_1), \ldots, t_\nu^{-1}(u_n))
            $$
            <p>o√π :</p>
            <ul>
                <li>$t_\nu$ est la fonction de r√©partition t-Student avec $\nu$ degr√©s de libert√©</li>
                <li>$t_{\mathbf{R},\nu}$ est la fonction de r√©partition t-Student multivari√©e</li>
                <li>$\nu$ contr√¥le l'√©paisseur des queues (plus $\nu$ est petit, plus les queues sont √©paisses)</li>
            </ul>
        </div>

        <div class="note" style="background: #f3e5f5; border-left-color: #9c27b0;">
            <div class="note-title" style="color: #6a1b9a;">üí° Pourquoi la copule t-Student est meilleure pour le stress testing ?</div>
            <p><strong>D√©pendance extr√™me (Tail Dependence) :</strong> Contrairement √† la copule Gaussienne, la copule t-Student a une <strong>d√©pendance extr√™me positive</strong>. Cela signifie que les √©v√©nements extr√™mes (pertes importantes) ont tendance √† se produire simultan√©ment.</p>
            
            <p><strong>Exemple :</strong> Avec une copule t-Student avec $\nu = 3$, si un actif baisse de plus de 20%, la probabilit√© qu'un autre actif baisse aussi de plus de 20% est beaucoup plus √©lev√©e qu'avec une copule Gaussienne.</p>
            
            <p><strong>Pourquoi c'est important pour le stress testing ?</strong> En p√©riode de crise, les actifs ont tendance √† chuter ensemble (corr√©lations augmentent). La copule t-Student capture cette r√©alit√©, permettant de mieux √©valuer le risque de portefeuille en p√©riode de stress.</p>
            
            <p><strong>Le param√®tre $\nu$ :</strong></p>
            <ul>
                <li>$\nu$ grand (ex: $\nu > 30$) : Proche de la copule Gaussienne (queues fines)</li>
                <li>$\nu$ petit (ex: $\nu = 3-5$) : Queues tr√®s √©paisses, forte d√©pendance extr√™me</li>
                <li>En pratique, $\nu = 3-10$ est souvent utilis√© pour mod√©liser les march√©s financiers</li>
            </ul>
        </div>

        <h3>12.3 Simulation de Sc√©narios avec Copules</h3>

        <div class="proof">
            <div class="proof-title">Algorithme de Simulation :</div>
            
            <div class="step">
                <span class="step-number">1</span>
                <strong>Estimation des marginales :</strong>
            </div>
            <p>Pour chaque actif $i$, on estime la distribution marginale $F_i$ (peut √™tre normale, t-Student, empirique, etc.)</p>
            
            <div class="step">
                <span class="step-number">2</span>
                <strong>Estimation de la copule :</strong>
            </div>
            <p>On estime les param√®tres de la copule (matrice de corr√©lation $\mathbf{R}$ et degr√©s de libert√© $\nu$ pour la copule t-Student) √† partir des donn√©es transform√©es $u_i = F_i(x_i)$.</p>
            
            <div class="step">
                <span class="step-number">3</span>
                <strong>Simulation :</strong>
            </div>
            <p>Pour g√©n√©rer un sc√©nario :</p>
            <ol type="a">
                <li>G√©n√©rer $(u_1, \ldots, u_n)$ depuis la copule (variables corr√©l√©es uniformes)</li>
                <li>Transformer via les quantiles : $x_i = F_i^{-1}(u_i)$</li>
            </ol>
            <p>On obtient ainsi des rendements $(x_1, \ldots, x_n)$ avec les bonnes marginales ET la bonne structure de d√©pendance.</p>
            
            <div class="step">
                <span class="step-number">4</span>
                <strong>Stress Testing :</strong>
            </div>
            <p>On peut :</p>
            <ul>
                <li>G√©n√©rer des milliers de sc√©narios avec la copule</li>
                <li>Calculer la distribution des rendements du portefeuille</li>
                <li>√âvaluer le CVaR, la VaR, et autres m√©triques de risque</li>
                <li>Comparer avec les sc√©narios historiques</li>
            </ul>
        </div>

        <div class="note" style="background: #fff9c4; border-left-color: #fbc02d;">
            <div class="note-title" style="color: #f57f17;">üí° Pourquoi cette approche est puissante pour le stress testing ?</div>
            <p><strong>Avantages :</strong></p>
            <ul>
                <li><strong>Flexibilit√© :</strong> On peut mod√©liser des marginales complexes (asym√©trie, queues √©paisses) ind√©pendamment de la d√©pendance</li>
                <li><strong>R√©alisme :</strong> La copule t-Student capture la d√©pendance extr√™me observ√©e en p√©riode de crise</li>
                <li><strong>G√©n√©ration de sc√©narios :</strong> On peut g√©n√©rer des sc√©narios de stress r√©alistes m√™me s'ils ne sont pas dans l'historique</li>
                <li><strong>Comparaison :</strong> On peut comparer diff√©rents mod√®les (Gaussien vs t-Student) pour voir l'impact sur le risque</li>
            </ul>
            
            <p><strong>Exemple d'application :</strong> Un portefeuille peut avoir un CVaR de 5% avec une copule Gaussienne, mais de 10% avec une copule t-Student (car elle capture mieux les crises simultan√©es). Le vrai risque est probablement plus proche de 10% !</p>
        </div>

        <div class="conclusion">
            <h2>üéì Synth√®se des 4 Chapitres Avanc√©s</h2>
            
            <div style="text-align: left; margin-top: 20px;">
                <p><strong>üîó Comment ces chapitres s'articulent :</strong></p>
                <ol style="margin-left: 20px; margin-top: 15px;">
                    <li><strong>CVaR (Chapitre 9) :</strong> Mesure le risque de mani√®re plus r√©aliste que la variance, en se concentrant sur les pertes extr√™mes. <strong>Lien :</strong> Utilise les copules pour estimer le CVaR avec des d√©pendances r√©alistes.</li>
                    
                    <li><strong>Optimisation Robuste (Chapitre 10) :</strong> Prot√®ge contre les erreurs d'estimation des param√®tres. <strong>Lien :</strong> Utilise une estimation robuste de covariance (Ledoit-Wolf) pour d√©finir l'ensemble d'incertitude.</li>
                    
                    <li><strong>Estimation Robuste (Chapitre 11) :</strong> Am√©liore l'estimation de $\boldsymbol{\Sigma}$ en r√©duisant le bruit. <strong>Lien :</strong> Fournit une meilleure base pour l'optimisation (classique ou robuste) et r√©duit le besoin de robustesse.</li>
                    
                    <li><strong>Copules (Chapitre 12) :</strong> Mod√©lise les d√©pendances complexes pour le stress testing. <strong>Lien :</strong> Permet d'√©valuer le CVaR de mani√®re plus r√©aliste et de g√©n√©rer des sc√©narios de stress pour tester la robustesse du portefeuille.</li>
                </ol>
                
                <p style="margin-top: 25px;"><strong>üí° Workflow complet :</strong></p>
                <ol style="margin-left: 20px; margin-top: 10px;">
                    <li><strong>Estimer</strong> $\boldsymbol{\Sigma}$ avec Ledoit-Wolf (Chapitre 11) pour r√©duire le bruit</li>
                    <li><strong>Optimiser</strong> le portefeuille avec optimisation robuste (Chapitre 10) pour prot√©ger contre les erreurs d'estimation</li>
                    <li><strong>√âvaluer</strong> le risque avec CVaR (Chapitre 9) au lieu de la variance</li>
                    <li><strong>Tester</strong> la r√©sistance avec des sc√©narios g√©n√©r√©s via copules (Chapitre 12)</li>
                </ol>
                
                <p style="margin-top: 25px;"><strong>üéØ Impact pratique :</strong></p>
                <p>Cette approche int√©gr√©e permet de :</p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>Construire des portefeuilles <strong>plus robustes</strong> aux erreurs d'estimation</li>
                    <li>Mieux <strong>√©valuer le risque r√©el</strong> (CVaR au lieu de variance)</li>
                    <li>Mieux <strong>pr√©parer aux crises</strong> (copules pour stress testing)</li>
                    <li>Am√©liorer la <strong>performance hors √©chantillon</strong> (estimation robuste)</li>
                </ul>
            </div>
        </div>

        <div class="conclusion">
            <h2>üéì Conclusion : Synth√®se des Liens Conceptuels</h2>
            
            <div style="text-align: left; margin-top: 20px;">
                <p><strong>üîó Le fil conducteur de la th√©orie :</strong></p>
                <ol style="margin-left: 20px; margin-top: 15px;">
                    <li><strong>Le probl√®me fondamental</strong> : Trouver le meilleur compromis rendement-risque ‚Üí <strong>Formulation QP</strong></li>
                    <li><strong>La garantie math√©matique</strong> : La convexit√© assure l'existence et l'unicit√© de la solution ‚Üí <strong>Propri√©t√©s de Œ£</strong></li>
                    <li><strong>La m√©thode de r√©solution</strong> : Les conditions KKT caract√©risent l'optimum ‚Üí <strong>Lagrangien et multiplicateurs</strong></li>
                    <li><strong>La solution pratique</strong> : R√©solution analytique (simple) ou num√©rique (g√©n√©rale) ‚Üí <strong>Algorithmes QP</strong></li>
                    <li><strong>L'application financi√®re</strong> : La fronti√®re efficiente visualise tous les portefeuilles optimaux ‚Üí <strong>Plan risque-rendement</strong></li>
                </ol>
                
                <p style="margin-top: 25px;"><strong>üí° Pourquoi tout cela fonctionne ensemble ?</strong></p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>La <strong>matrice de covariance Œ£</strong> capture les relations entre actifs (diversification)</li>
                    <li>La <strong>convexit√©</strong> garantit qu'on trouve toujours le vrai optimum (pas de pi√®ges locaux)</li>
                    <li>Les <strong>contraintes</strong> refl√®tent les r√®gles r√©elles (budget, diversification, r√©glementation)</li>
                    <li>Les <strong>conditions KKT</strong> lient math√©matiquement l'optimum aux contraintes (√©quilibre)</li>
                    <li>La <strong>fronti√®re efficiente</strong> montre visuellement le compromis optimal pour chaque niveau de risque</li>
                </ul>
                
                <p style="margin-top: 25px;"><strong>üéØ Impact pratique :</strong></p>
                <p>Cette th√©orie permet aux g√©rants de portefeuille de :</p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>Allouer le capital de mani√®re <strong>scientifique</strong> (pas juste intuitive)</li>
                    <li>Respecter les <strong>contraintes r√©glementaires</strong> (OPCVM) tout en optimisant</li>
                    <li>Visualiser et communiquer les <strong>compromis rendement-risque</strong></li>
                    <li>Adapter l'allocation selon l'<strong>aversion au risque</strong> de l'investisseur</li>
                </ul>
            </div>
            
            <p style="margin-top: 30px; text-align: center;"><strong>Cette d√©monstration math√©matique rigoureuse montre la compr√©hension profonde des fondements th√©oriques de l'optimisation de portefeuille, avec une vision claire des liens entre chaque concept.</strong></p>
        </div>

        <div style="margin-top: 40px; text-align: center; color: #666; font-size: 0.9em;">
            <p>D√©velopp√© pour le <strong>Data & AI Internship Challenge 2026 - Wafa Gestion</strong></p>
            <p style="margin-top: 10px;">D√©monstration math√©matique compl√®te - Programmation Quadratique</p>
        </div>
    </div>
    
    <script>
        // V√©rification que le contenu est charg√©
        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ Document charg√© avec succ√®s');
            console.log('‚úÖ Container trouv√©:', document.querySelector('.container') !== null);
            console.log('‚úÖ MathJax configur√©:', typeof window.MathJax !== 'undefined');
        });
        
        // V√©rification du chargement de MathJax
        window.addEventListener('load', function() {
            if (typeof MathJax !== 'undefined' && MathJax.startup) {
                console.log('‚úÖ MathJax charg√© avec succ√®s');
            } else {
                console.warn('‚ö†Ô∏è MathJax n\'est pas encore charg√©, attendez quelques secondes...');
                setTimeout(function() {
                    if (typeof MathJax !== 'undefined' && MathJax.startup) {
                        console.log('‚úÖ MathJax charg√© apr√®s d√©lai');
                    } else {
                        console.error('‚ùå MathJax n\'a pas pu se charger. V√©rifiez votre connexion internet.');
                    }
                }, 5000);
            }
        });
    </script>
</body>
</html>

